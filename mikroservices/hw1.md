
# Домашнее задание к занятию «Микросервисы: принципы»

Вы работаете в крупной компании, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps-специалисту необходимо выдвинуть предложение по организации инфраструктуры для разработки и эксплуатации.

## Задача 1: API Gateway 

Предложите решение для обеспечения реализации API Gateway. Составьте сравнительную таблицу возможностей различных программных решений. На основе таблицы сделайте выбор решения.

Решение должно соответствовать следующим требованиям:
- маршрутизация запросов к нужному сервису на основе конфигурации,
- возможность проверки аутентификационной информации в запросах,
- обеспечение терминации HTTPS.

Обоснуйте свой выбор.

**Ответ**

| Возможности               | Kong                   | AWS API Gateway         | NGINX                   | KrakenD                |
|---------------------------|------------------------|-------------------------|-------------------------|------------------------|
| **Маршрутизация запросов**| Да, на основе конфигурации | Да, через REST API и веб-интерфейс | Да, через конфигурационные файлы | Да, через конфигурацию JSON |
| **Аутентификация**        | Да (JWT, OAuth 2.0 и др.) | Да (IAM, JWT, Lambda authorizers) | Да (можно настроить обработчики) | Да (JWT, OAuth 2.0 и др.) |
| **Терминация HTTPS**      | Да                     | Да                      | Да                      | Да                     |
| **Лимитирование пропускной способности** | Да                     | Да                     | Да (с помощью дополнительной конфигурации) | Да                     |
| **Мониторинг и логирование** | Да (через Konga и другие плагины) | Да (интеграция с CloudWatch) | Да (с помощью дополнительных модулей) | Да (интеграция с Prometheus) |
| **Интеграция с другими сервисами** | Да (с помощью плагинов) | Да (AWS-сервисы)      | Да (гибкая конфигурация) | Да (поддержка различных бэкендов) |
| **Скейтабилити**          | Высокая (можно кластеризовать) | Высокая (управляется AWS) | Средняя (в зависимости от конфигурации) | Высокая (может масштабироваться) |
| **Цена**                  | Бесплатно, но с платными плагинами | Платно по использованию API | Бесплатно (открытый исходный код)             | Бесплатно (открытый исходный код) |

### Обоснование выбора решения

Kong - предлагает мощные возможности, особенно благодаря плагинам, и подходит для большинства бизнес-требований.
AWS API Gateway - хорош для пользователей, работающих с AWS, но может быть дорогим.
NGINX - требует больше времени на настройку, но предоставляет высокий уровень контроля.
KrakenD - предлагает простую конфигурацию через JSON, эффективную интеграцию с различными бэкендами и хорошую поддерживает масштабируемость. Это решение отлично подходит для компаний, которые хотят быстро разворачивать API Gateway без больших затрат.

### Выбор

KrakenD — для тех, кто ищет простоту конфигурации и высокую производительность, а также легкость в интеграции с различными сервисами.

## Задача 2: Брокер сообщений

Составьте таблицу возможностей различных брокеров сообщений. На основе таблицы сделайте обоснованный выбор решения.

Решение должно соответствовать следующим требованиям:
- поддержка кластеризации для обеспечения надёжности,
- хранение сообщений на диске в процессе доставки,
- высокая скорость работы,
- поддержка различных форматов сообщений,
- разделение прав доступа к различным потокам сообщений,
- простота эксплуатации.

Обоснуйте свой выбор.

**Ответ**

| Возможности                   | Apache Kafka            | RabbitMQ                | ActiveMQ               | NATS                  |
|-------------------------------|-------------------------|-------------------------|------------------------|-----------------------|
| **Кластеризация**             | Да                      | Да                      | Да                     | Да                    |
| **Хранение сообщений на диске** | Да                      | Да                      | Да                     | Нет                   |
| **Высокая скорость работы**    | Очень высокая           | Высокая                 | Средняя                | Очень высокая         |
| **Поддержка различных форматов сообщений** | Да (обычно JSON, Avro и т.д.) | Да (AMQP, MQTT, STOMP и др.) | Да (AMQP, MQTT)         | Да (JSON, MsgPack и др.) |
| **Разделение прав доступа**    | Да                      | Да                      | Да                     | Ограниченное (простые ACL) |
| **Простота эксплуатации**      | Может требовать больше усилий в настройке и мониторинге | Относительно прост в использовании | Умеренная сложность в настройке | Очень прост в использовании |

### Обоснование выбора решения

Apache Kafka:
Подходит для приложений, которые требуют высокой производительности и обработки больших объёмов данных в реальном времени.
Обеспечивает надежность через кластеризацию и хранение сообщений на диске.
Гибкость в поддержке различных форматов сообщений.
Однако требует определённых усилий для эксплуатации и настройки, что может быть сложным для небольших команд.
RabbitMQ:
Хорошо подходит для распределённых систем и поддерживает множество протоколов.
Имеет хорошую поддержку управления правами доступа.
Обеспечивает хранение сообщений на диске, но может быть менее производительным, чем Kafka для крупных данных.
ActiveMQ:
Обеспечивает богатый функционал и поддерживает различные протоколы, но может быть менее производительным по сравнению с Kafka.
Обладает хорошей поддержкой управления правами доступа и хранением сообщений, но требует умеренных усилий для эксплуатации.
NATS:
Обеспечивает очень высокую скорость работы и простоту в использовании.
Однако не поддерживает хранение сообщений на диске, что может быть критичным для некоторых приложений.
Игнорирует сложные механизмы управления доступом, предлагая более простые ACL.

### Выбор

Apache Kafka - обеспечивает всё необходимое для обработки больших объёмов данных с высокой скоростью.
Поддержка кластеризации и хранение сообщений на диске гарантируют надежность.
Гибкость в поддержке различных форматов сообщений и возможность настройки прав доступа делают его подходящим выбором для сложных распределённых систем.

---

#### [Дополнительные материалы: как запускать, как тестировать, как проверить](https://github.com/netology-code/devkub-homeworks/tree/main/11-microservices-02-principles)

---

### Как оформить ДЗ?

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.

---
